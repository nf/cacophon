<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/polymer-signals/polymer-signals.html">
<link rel="import" href="/bower_components/webaudio-buffer-draw/webaudio-buffer-draw.html">

<polymer-element name="cacophon-sound-list">
  <template>
    <polymer-signals on-polymer-signal-sails-sound-create="{{ soundCreated }}"></polymer-signals>
    <style>
      #soundList {
        position: absolute;
	top: 650px;
	width: 350px;
	margin-left: 50%;
	left: -175px;
      }
      webaudio-buffer-draw {
        background: grey;
      }
    </style>
    <ul id="soundList">
      <template repeat="{{ s in sounds }}">
        <li>
          <div>
            <a href="/sounds/{{ s.id }}">/sounds/{{ s.id }}</a>
            <span>{{ s.createdAt }}</span>
          </div>
          <webaudio-buffer-draw src="data:audio/mp3;base64,{{ s.mp3 }}"></webaudio-buffer-draw>
        </li>
      </template>
    </ul>
  </template>
  <script>
    Polymer('cacophon-sound-list', {
      created: function() {
        this.sounds = [];
      },
      soundCreated: function(e, detail, sender) {
        this.sounds.unshift(detail);
      }
    });
  </script>
</polymer-element>
